# Работа с памятью

Низкоуровневые языки программирования \(например, C\) имеют низкоуровневые примитивы для управления памятью, такие как `malloc()`и `free()`. В JavaScript же память выделяется динамически при создании сущностей \(т.е., объектов, строк и т.п.\) и "автоматически" освобождается, когда они больше не используются. Последний процесс называется _сборкой мусора_. Слово "автоматически" является источником путаницы и зачастую создает у программистов на JavaScript \(и других высокоуровневых языках\) ложное ощущение, что они могут не заботиться об управлении памятью.

---

## Жизненный цикл памяти {#Жизненный_цикл_памяти}

Независимо от языка программирования, жизненный цикл памяти практически всегда один и тот же:

1. Выделение необходимой памяти.
2. Её использование \(чтение, запись\).
3. Освобождение выделенной памяти, когда в ней более нет необходимости.

Первые два пункта осуществляются явным образом \(т.е., непосредственно программистом\) во всех языках программирования. Третий пункт осуществляется явным образом в низкоуровневых языках, но в большинстве высокоуровневых языков, в том числе и в JavaScript, осуществляется автоматически.

### Выделение памяти в JavaScript {#Выделение_памяти_в_JavaScript}

#### Выделение памяти при инициализации значений переменных {#Выделение_памяти_при_инициализации_значений_переменных}

Чтобы не утруждать программиста заботой о низкоуровневых операциях выделения памяти, интерпретатор JavaScript динамически выделяет необходимую память при объявлении переменных:

```js
var n = 123; // выделяет память для типа number
var s = "azerty"; // выделяет память для типа string 

var o = {
  a: 1,
  b: null
}; // выделяет память для типа object и всех его внутренних переменных

var a = [1, null, "abra"]; // (like object) выделяет память для array и его внутренних значений

function f(a){
  return a + 2;
} // выделяет память для function (которая представляет собой вызываемый объект)

// функциональные выражения также выделяют память под object
someElement.addEventListener('click', function(){
  someElement.style.backgroundColor = 'blue';
}, false);
```

#### Выделение памяти при вызовах функций {#Выделение_памяти_при_вызовах_функций}

Вызовы некоторых функций также ведут к выделению памяти под объект:

```js
var d = new Date();
var e = document.createElement('div'); // выделяет память под DOM элемент
```

Некоторые методы выделяют память для новых значений или объектов:

```js
var s = "azerty";
var s2 = s.substr(0, 3); // s2 это новый объект типа string
// Т.к. строки - это постоянные значения, интерпретатор может решить, что память выделять не нужно, но нужно лишь сохранить диапазон [0, 3].

var a = ["ouais ouais", "nan nan"];
var a2 = ["generation", "nan nan"];
var a3 = a.concat(a2); // новый массив с 4 элементами в результате конкатенации элементов 'a' и 'a2'
```

### Использование значений {#Использование_значений}

"Использование значений", как правило, означает -  чтение и запись значений из/в выделенной для них области памяти. Это происходит при чтении или записи значения какой-либо переменной, или свойства объекта или даже при передаче аргумента функции.

